<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>pathagarlens</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Inter', sans-serif;
  background:#f5f7fa;
  color:#222;
}
h1,h2,h3{
  font-family:'Playfair Display', serif;
}
a{
  text-decoration:none;
  color:inherit;
}

/* Navbar */
.navbar{
  background:white;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:15px 40px;
  box-shadow:0 2px 6px rgba(0,0,0,0.05);
  position:sticky;
  top:0;
  z-index:1000;
}
.nav-left{
  display:flex;
  align-items:center;
}
.nav-links a{
  margin-left:20px;
  font-weight:500;
}
.nav-right{
  display:flex;
  align-items:center;
  gap:20px;
}
.login-btn{
  background:#0a2a66;
  color:white;
  padding:8px 14px;
  border-radius:6px;
  font-size:14px;
}
.admin-btn{
  background:#444;
  color:white;
  padding:8px 14px;
  border-radius:6px;
  font-size:14px;
}
.hamburger{
  font-size:24px;
  cursor:pointer;
}

/* Dropdown */
.dropdown{
  position: fixed;
  right: 40px;
  top: 70px;
  background: white;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  border-radius: 6px;
  display: none;
  min-width: 200px;
  z-index: 2000;
}
.dropdown a{
  display:block;
  padding:12px 15px;
  border-bottom:1px solid #eee;
}
.dropdown a:hover{
  background:#f2f2f2;
}


/* Header Section */
.page-header{
  background:#0a2a66;
  color:white;
  text-align:center;
  padding:70px 20px;
}
.page-header h1{
  font-size:34px;
}
.page-header p{
  margin-top:10px;
  opacity:0.9;
}

/* Search Section */
.search-section{
  max-width:900px;
  margin:40px auto;
  padding:0 20px;
  text-align:center;
}
.search-section form{
  display:flex;
  justify-content:center;
  gap:10px;
}
.search-section input{
  width:60%;
  padding:14px;
  border-radius:6px;
  border:1px solid #ddd;
  font-size:16px;
}
.search-section button{
  padding:14px 22px;
  border:none;
  border-radius:6px;
  background:#0a2a66;
  color:white;
  font-weight:600;
  cursor:pointer;
}

/* Results */
.results-container{
  max-width:1000px;
  margin:40px auto;
  padding:0 20px;
}
.result-card{
  background:white;
  padding:25px;
  border-radius:10px;
  box-shadow:0 4px 12px rgba(0,0,0,0.06);
  margin-bottom:25px;
}

.result-title{
  font-size:20px;
  font-weight:700;
  margin-bottom:10px;
  color:#0a2a66;
}

.result-meta{
  font-size:14px;
  margin-bottom:6px;
  color:#555;
}

.result-source{
  font-size:13px;
  font-weight:600;
  color:#888;
  margin-bottom:8px;
}

.read-btn{
  display:inline-block;
  margin-top:10px;
  padding:8px 16px;
  background:#0a2a66;
  color:white;
  border-radius:6px;
  font-size:14px;
}

.read-btn:hover{
  opacity:0.9;
}

 /* Abstract,keyword,top-arrow */ 
  
.abstract-box{
  margin-top:8px;
  font-size:14px;
  color:#444;
  line-height:1.6;
}

.keyword-box{
  margin-top:6px;
  font-size:13px;
  color:#0a2a66;
}

.top-arrow{
  position:fixed;
  bottom:25px;
  right:25px;
  background:#0a2a66;
  color:white;
  width:45px;
  height:45px;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:50%;
  cursor:pointer;
  font-size:20px;
  display:none;
  box-shadow:0 4px 10px rgba(0,0,0,0.2);
}

/* Load More */
.load-more{
  text-align:center;
  margin:30px 0;
}
.load-more button{
  padding:10px 25px;
  background:#0a2a66;
  color:white;
  border:none;
  border-radius:6px;
  cursor:pointer;
}

/* Footer (same as index) */
.footer{
  background:#0a2a66;
  color:white;
  padding:50px 20px;
}
.footer-container{
  max-width:1100px;
  margin:auto;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:30px;
}
.footer a{
  display:block;
  margin-bottom:8px;
  color:#ddd;
}
.bottom{
  text-align:center;
  margin-top:30px;
  font-size:14px;
  opacity:0.8;
}

/* Mobile */
@media(max-width:768px){
  .navbar{flex-direction:column;align-items:flex-start;padding:12px 20px}
  .nav-links{display:none}
  .search-section form{flex-direction:column}
  .search-section input{width:100%}
}
</style>
</head>

<body>

<!-- Navbar -->
<div class="navbar">
  <div class="nav-left">
    <h2>Pathagar | Lens</h2>
    <div class="nav-links">
      <a href="index.html">Home</a>
      <a href="journal.html">Journals</a>
      <a href="categories.html">Categories</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
    </div>
  </div>

  <div class="nav-right">
        <div class="hamburger" onclick="toggleMenu()">‚ò∞</div>
  </div>
</div>

<!-- Dropdown -->
<div class="dropdown" id="dropdownMenu">
  <a href="profile.html">Profile</a>
  <a href="setting.html">Settings</a>
  <a href="reg.html">Register</a>
  <a href="contact.html">Contact</a>
  <a href="admin.html">Admin Panel</a>
</div>





<!-- Header -->
<div class="page-header">
  <h1>Explore Scholarly Journals</h1>
  <p>Search and discover academic research from multiple trusted sources</p>
</div>

<!-- Search -->
<div class="search-section">
  <form action="journal.html" method="GET" style="display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap;">

    <input type="text" id="searchInput" name="q" placeholder="Search journals..." required>
    <button type="submit">Search</button>

    <select id="sortSelect" style="padding:12px; border-radius:6px;">
      <option value="default">Sort: Default</option>
      <option value="newest">Newest First</option>
      <option value="oldest">Oldest First</option>
    </select>


       <!-- üîΩ HISTORY DROPDOWN -->
    <div id="historyList" style="
      position:absolute;
      top:60px;
      left:0;
      width:100%;
      background:white;
      box-shadow:0 4px 12px rgba(0,0,0,0.1);
      border-radius:6px;
      display:none;
      z-index:1000;
    "></div>
  </form>
  
<div id="searchInfo" style="
  margin-top:15px;
  font-weight:600;
  color:#0a2a66;
"></div>
  
</div>
  
<!-- Results -->
<div class="results-container">
  <div id="journalResults"></div>
</div>
  
<div id="pagination" style="text-align:center; margin:30px 0;"></div>



<div class="top-arrow" id="topArrow">‚Üë</div>

<!-- Footer -->
<div class="footer">
  <div class="footer-container">
    <div>
      <h4>Pathagar | Lens</h4>
      <p>A unified academic journal discovery platform built for researchers and students.</p>
    </div>
    <div>
      <h4>Quick Links</h4>
      <a href="index.html">Home</a>
      <a href="journal.html">Journals</a>
      <a href="categories.html">Categories</a>
      <a href="contact.html">Contact</a>
    </div>
    <div>
      <h4>_____</h4>
      <a href="#">API Access</a>
      <a href="privacy.html">Privacy Policy</a>
      <a href="about.html">About</a>

    </div>
    <div>
      <h4>Contact</h4>
      <p>Email: pathagarlens@yahoo.com</p>
      <p>Cooch Behar, West Bengal, India (This is not the official address.)</p>
    </div>
  </div>

  <div class="bottom">
    ¬© 2026 Pathagar Lens | All Rights Reserved | Design by Paradip Sen Roy
  </div>
</div>


<script>
function toggleMenu(){
  var menu = document.getElementById("dropdownMenu");
  menu.style.display = menu.style.display === "block" ? "none" : "block";
}

document.addEventListener("click", function(event){
  var menu = document.getElementById("dropdownMenu");
  var hamburger = document.querySelector(".hamburger");

  if(!menu.contains(event.target) && !hamburger.contains(event.target)){
    menu.style.display = "none";
  }
});
</script>

<script>
let currentPage = 1;
let perPage = 10;
const MAX_PAGE = 500;  
let currentResults = [];
let currentSort = "default";

  // =======================
// SHUFFLE FUNCTION
// =======================
function shuffleArray(array){
  for (let i = array.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}


// =======================
// LOAD RESULTS


async function loadResults(){

  showLoading(true);
  
  const urlParams = new URLSearchParams(window.location.search);
const query = urlParams.get("q");

if(!query) return;

// üî• Search box ‡¶è query ‡¶¨‡¶∏‡¶æ‡¶®‡ßã
document.getElementById("searchInput").value = query;

// üî• ‡¶®‡¶ø‡¶ö‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
document.getElementById("searchInfo").innerHTML =
  `Showing results for: "<span style="color:black">${query}</span>"`;


  try{
    const response = await fetch(`/api/search?q=${query}&page=${currentPage}`);
    const data = await response.json();

    currentResults = data.results || [];

    applySort();
    renderResults();
    renderPagination();

  }catch(err){
    console.error("Fetch error:", err);
  }

  showLoading(false);
}

// =======================
// RENDER RESULTS
// =======================
function renderResults(){

  const container = document.getElementById("journalResults");
  container.innerHTML = "";

  const startNumber = (currentPage - 1) * perPage;

  currentResults.forEach((item,index)=>{

    const number = startNumber + index + 1;

    container.innerHTML += `
      <div class="result-card">
        <div class="result-source">
          #${number} ‚Ä¢ ${item.source || "Unknown"}
        </div>

        <div class="result-title">${item.title || "No Title"}</div>

        <div class="result-meta">
          <strong>Authors:</strong> ${formatAuthors(item.authors)}
        </div>

        <div class="result-meta">
          <strong>Journal:</strong> ${item.journal || "N/A"}
        </div>

        <div class="result-meta">
          <strong>Year:</strong> ${item.year || "N/A"}
        </div>

        ${item.doi ? `
          <div class="result-meta">
            <strong>DOI:</strong>
            <a href="https://doi.org/${item.doi}" target="_blank">
              ${item.doi}
            </a>
          </div>
        ` : ""}

        ${item.link ? `
          <a href="${item.link}" target="_blank" class="read-btn">
            Visit Article ‚Üí
          </a>
        ` : ""}
      </div>
    `;
  });
}

// =======================
// AUTHOR FORMAT
// =======================
function formatAuthors(authors){
  if(!authors) return "N/A";
  const arr = authors.split(",");
  if(arr.length <= 5) return authors;
  return arr.slice(0,5).join(", ") + " et al.";
}

// =======================
// SORT
// =======================
function applySort(){

  if(currentSort === "newest"){
    currentResults.sort((a,b)=> (parseInt(b.year)||0)-(parseInt(a.year)||0));
  }

  if(currentSort === "oldest"){
    currentResults.sort((a,b)=> (parseInt(a.year)||0)-(parseInt(b.year)||0));
  }
}

// =======================
// PAGINATION (Prev / Next)
// =======================

let visiblePages = 5;   // ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶ï‡ßü‡¶ü‡¶æ page number ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá

function renderPagination(){

  const pagination = document.getElementById("pagination");
  pagination.innerHTML = "";

  const MAX_PAGE = 500;
  let html = "";

  if(currentPage > 1){
    html += `<button onclick="changePage(${currentPage-1})">Prev</button>`;
  }

  let startPage = Math.max(1, currentPage - 2);
  let endPage = Math.min(MAX_PAGE, currentPage + 2);

  for(let i = startPage; i <= endPage; i++){
    html += `
      <button 
        onclick="changePage(${i})"
        style="
          margin:5px;
          padding:6px 12px;
          ${i===currentPage ? 'background:#0a2a66;color:white;' : ''}
        ">
        ${i}
      </button>
    `;
  }

  if(currentPage < MAX_PAGE){
    html += `<button onclick="changePage(${currentPage+1})">Next</button>`;
  }

  pagination.innerHTML = html;
}

// =======================
// CHANGE PAGE
// =======================
function changePage(page){
  if(page < 1) return;
  currentPage = page;
  loadResults();
}

// =======================
// LOADING
// =======================
function showLoading(show){

  let box = document.getElementById("loadingBox");

  if(!box){
    box = document.createElement("div");
    box.id = "loadingBox";
    box.style.textAlign = "center";
    box.style.fontWeight = "600";
    box.style.margin = "10px";
    document.querySelector(".results-container").prepend(box);
  }

  box.innerHTML = show ? "Loading..." : "";
}

// =======================
// SORT DROPDOWN
// =======================
document.getElementById("sortSelect").addEventListener("change", function(){
  currentSort = this.value;
  applySort();
  renderResults();
});

// =======================
// INITIAL LOAD
// =======================
loadResults();

  <script>

// =======================
// SEARCH HISTORY SYSTEM
// =======================

const searchInput = document.getElementById("searchInput");
const historyList = document.getElementById("historyList");

function saveSearch(query){

  if(!query) return;

  let history = JSON.parse(localStorage.getItem("searchHistory")) || [];

  history = history.filter(item => item !== query);

  history.unshift(query);

  if(history.length > 8){
    history = history.slice(0,8);
  }

  localStorage.setItem("searchHistory", JSON.stringify(history));
}

function showHistory(){

  let history = JSON.parse(localStorage.getItem("searchHistory")) || [];

  if(history.length === 0) return;

  historyList.innerHTML = "";

  history.forEach(item=>{
    historyList.innerHTML += `
      <div style="
        padding:10px;
        cursor:pointer;
        border-bottom:1px solid #eee;
      "
      onclick="selectHistory('${item}')">
        ${item}
      </div>
    `;
  });

  historyList.style.display = "block";
}

function selectHistory(value){
  searchInput.value = value;
  historyList.style.display = "none";
  window.location.href = `journal.html?q=${encodeURIComponent(value)}`;
}

document.addEventListener("click", function(e){
  if(!searchInput.contains(e.target)){
    historyList.style.display = "none";
  }
});

searchInput.addEventListener("focus", showHistory);

document.addEventListener("DOMContentLoaded", function(){

  const urlParams = new URLSearchParams(window.location.search);
  const query = urlParams.get("q");

  if(query){
    saveSearch(query);
  }

});

</script>
</script>

  
<script>
  console.log("Script Loaded");
    </script>
  <script>
document.addEventListener("DOMContentLoaded", function(){
  console.log("Journal JS Running");
});
</script>
    
<script>
const topArrow = document.getElementById("topArrow");

window.addEventListener("scroll", () => {
  if(window.scrollY > 400){
    topArrow.style.display = "flex";
  } else {
    topArrow.style.display = "none";
  }
});

topArrow.addEventListener("click", () => {
  window.scrollTo({
    top:0,
    behavior:"smooth"
  });
});
</script>
  
</body>
</html>















